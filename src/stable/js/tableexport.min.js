/*!
 * TableExport.js v3.3.9 (https://www.travismclarke.com)
 * Copyright 2016 Travis Clarke
 * Licensed under the MIT license
 */
!function(a,b){"function"==typeof define&&define.amd?define(["exports","jquery","blobjs","file-saverjs","xlsx-js"],b):"object"==typeof exports&&"string"!=typeof exports.nodeName?b(exports,require("jquery"),require("blobjs"),require("file-saverjs"),require("xlsx-js")):b(a,a.jQuery,a.Blob,a.saveAs,a.XLSX)}(this||window,function(a,b,c,d,e){"use strict";var f=function(a,c,d){var g=this;g.settings=d?c:b.extend({},f.prototype.defaults,c),g.selectors=a;var m,n,o,h=f.prototype.rowDel,i=g.settings.ignoreRows instanceof Array?g.settings.ignoreRows:[g.settings.ignoreRows],j=g.settings.ignoreCols instanceof Array?g.settings.ignoreCols:[g.settings.ignoreCols],k=g.settings.ignoreCSS instanceof Array?g.settings.ignoreCSS.join(", "):g.settings.ignoreCSS,l=g.settings.emptyCSS instanceof Array?g.settings.emptyCSS.join(", "):g.settings.emptyCSS;return g.settings.bootstrap?(m=f.prototype.bootstrap[0]+" ",n=f.prototype.bootstrap[1]+" ",o=f.prototype.bootstrap[2]+" "):(m=f.prototype.defaultButton+" ",n=o=""),g.selectors.each(function(){function s(a){return g.settings.trimWhitespace?a.trim():a}function t(b){var c=a.find("caption:not(.head)");c.length?c.append(b):a.prepend('<caption class="'+o+g.settings.position+'">'+b+"</caption>")}function u(a,b,c){var d="<button data-fileblob='"+a+"' class='"+m+n+c+"'>"+b+"</button>";t(d)}var a=b(this);d&&a.find("caption:not(.head)").remove();var c=a.find("tbody").find("tr"),c=g.settings.headings?c.add(a.find("thead>tr")):c,c=g.settings.footers?c.add(a.find("tfoot>tr")):c,p=g.settings.headings?a.find("thead>tr").length:0,q="id"===g.settings.fileName?a.attr("id")?a.attr("id"):f.prototype.defaultFileName:g.settings.fileName,r={xlsx:function(a,d){var e={},g=c.map(function(a,c){if(!~i.indexOf(a-p)&&!b(c).is(k)){var d=b(c).find("th, td");return[d.map(function(c,d){if(!~j.indexOf(c)&&!b(d).is(k)){if(b(d).is(l))return" ";if(d.hasAttribute("colspan")&&(e[a]=e[a]||{},e[a][c+1]=d.getAttribute("colspan")-1),d.hasAttribute("rowspan"))for(var f=1;f<d.getAttribute("rowspan");f++)e[a+f]=e[a+f]||{},e[a+f][c]=1;if(e[a]){for(var g=c+1,h=0,i=0,f=0;f<=Math.max.apply(Math,Object.keys(e[a]))&&(e[a][f]?h=i>=c?h+e[a][f]:h:i++,i!==g);f++);return new Array(h).concat(b(d).text())}return s(b(d).text())}}).get()]}}).get(),h=f.prototype.escapeHtml(JSON.stringify({data:g,fileName:d,mimeType:f.prototype.xlsx.mimeType,fileExtension:f.prototype.xlsx.fileExtension})),m=f.prototype.xlsx.buttonContent,n=f.prototype.xlsx.defaultClass;u(h,m,n)},xlsm:function(a,d){var e={},g=c.map(function(a,c){if(!~i.indexOf(a-p)&&!b(c).is(k)){var d=b(c).find("th, td");return[d.map(function(c,d){if(!~j.indexOf(c)&&!b(d).is(k)){if(b(d).is(l))return" ";if(d.hasAttribute("colspan")&&(e[a]=e[a]||{},e[a][c+1]=d.getAttribute("colspan")-1),d.hasAttribute("rowspan"))for(var f=1;f<d.getAttribute("rowspan");f++)e[a+f]=e[a+f]||{},e[a+f][c]=1;if(e[a]){for(var g=c+1,h=0,i=0,f=0;f<=Math.max.apply(Math,Object.keys(e[a]))&&(e[a][f]?h=i>=c?h+e[a][f]:h:i++,i!==g);f++);return new Array(h).concat(b(d).text())}return s(b(d).text())}}).get()]}}).get(),h=f.prototype.escapeHtml(JSON.stringify({data:g,fileName:d,mimeType:f.prototype.xls.mimeType,fileExtension:f.prototype.xls.fileExtension})),m=f.prototype.xls.buttonContent,n=f.prototype.xls.defaultClass;u(h,m,n)},xls:function(a,d){var e=f.prototype.xls.separator,g=c.map(function(a,c){if(!~i.indexOf(a-p)&&!b(c).is(k)){var d=b(c).find("th, td");return d.map(function(a,c){if(!~j.indexOf(a)&&!b(c).is(k))return b(c).is(l)?" ":s(b(c).text())}).get().join(e)}}).get().join(a),h=f.prototype.escapeHtml(JSON.stringify({data:g,fileName:d,mimeType:f.prototype.xls.mimeType,fileExtension:f.prototype.xls.fileExtension})),m=f.prototype.xls.buttonContent,n=f.prototype.xls.defaultClass;u(h,m,n)},csv:function(a,d){var e=f.prototype.csv.separator,g=c.map(function(a,c){if(!~i.indexOf(a-p)&&!b(c).is(k)){var d=b(c).find("th, td");return d.map(function(a,c){if(!~j.indexOf(a)&&!b(c).is(k))return b(c).is(l)?" ":'"'+s(b(c).text().replace(/"/g,'""'))+'"'}).get().join(e)}}).get().join(a),h=f.prototype.escapeHtml(JSON.stringify({data:g,fileName:d,mimeType:f.prototype.csv.mimeType,fileExtension:f.prototype.csv.fileExtension})),m=f.prototype.csv.buttonContent,n=f.prototype.csv.defaultClass;u(h,m,n)},txt:function(a,d){var e=f.prototype.txt.separator,g=c.map(function(a,c){if(!~i.indexOf(a-p)&&!b(c).is(k)){var d=b(c).find("th, td");return d.map(function(a,c){if(!~j.indexOf(a)&&!b(c).is(k))return b(c).is(l)?" ":s(b(c).text())}).get().join(e)}}).get().join(a),h=f.prototype.escapeHtml(JSON.stringify({data:g,fileName:d,mimeType:f.prototype.txt.mimeType,fileExtension:f.prototype.txt.fileExtension})),m=f.prototype.txt.buttonContent,n=f.prototype.txt.defaultClass;u(h,m,n)}};g.settings.formats.forEach(function(a){!(!e||"xls"!==a)&&(a="xlsm"),!e&&"xlsx"===a&&(a=null),a&&r[a](h,q)})}),b("button[data-fileblob]").off("click").on("click",function(){var a=b(this).data("fileblob"),c=a.data,d=a.fileName,e=a.mimeType,g=a.fileExtension;f.prototype.export2file(c,e,d,g)}),g};f.prototype={version:"3.3.9",defaults:{headings:!0,footers:!0,formats:["xls","csv","txt"],fileName:"id",bootstrap:!0,position:"bottom",ignoreRows:null,ignoreCols:null,ignoreCSS:".tableexport-ignore",emptyCSS:".tableexport-empty",trimWhitespace:!1},charset:"charset=utf-8",defaultFileName:"myDownload",defaultButton:"button-default",bootstrap:["btn","btn-default","btn-toolbar"],rowDel:"\r\n",entityMap:{"&":"&#38;","<":"&#60;",">":"&#62;","'":"&#39;","/":"&#47;"},xlsx:{defaultClass:"xlsx",buttonContent:"Export to xlsx",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fileExtension:".xlsx"},xls:{defaultClass:"xls",buttonContent:"Export to xls",separator:"\t",mimeType:"application/vnd.ms-excel",fileExtension:".xls"},csv:{defaultClass:"csv",buttonContent:"Export to csv",separator:",",mimeType:"text/csv",fileExtension:".csv"},txt:{defaultClass:"txt",buttonContent:"Export to txt",separator:"  ",mimeType:"text/plain",fileExtension:".txt"},escapeHtml:function(a){return String(a).replace(/[&<>'\/]/g,function(a){return f.prototype.entityMap[a]})},dateNum:function(a,b){b&&(a+=1462);var c=Date.parse(a);return(c-new Date(Date.UTC(1899,11,30)))/864e5},createSheet:function(a){for(var b={},c={s:{c:1e7,r:1e7},e:{c:0,r:0}},d=0;d!=a.length;++d)for(var f=0;f!=a[d].length;++f){c.s.r>d&&(c.s.r=d),c.s.c>f&&(c.s.c=f),c.e.r<d&&(c.e.r=d),c.e.c<f&&(c.e.c=f);var g={v:a[d][f]};if(null!=g.v){var h=e.utils.encode_cell({c:f,r:d});"number"==typeof g.v?g.t="n":"boolean"==typeof g.v?g.t="b":g.v instanceof Date?(g.t="n",g.z=e.SSF._table[14],g.v=this.dateNum(g.v)):g.t="s",b[h]=g}}return c.s.c<1e7&&(b["!ref"]=e.utils.encode_range(c)),b},Workbook:function(){this.SheetNames=[],this.Sheets={}},string2ArrayBuffer:function(a){for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0;d!=a.length;++d)c[d]=255&a.charCodeAt(d);return b},export2file:function(a,b,f,g){if(e&&".xls"==g.substr(0,4)){var h=new this.Workbook,i=this.createSheet(a);h.SheetNames.push(f),h.Sheets[f]=i;var j={bookType:g.substr(1,3)+(g.substr(4)||"m"),bookSST:!1,type:"binary"},k=e.write(h,j);a=this.string2ArrayBuffer(k)}var l=new c([a],{type:b+";"+this.charset});navigator.appVersion.toString().indexOf(".NET")>0?window.navigator.msSaveOrOpenBlob(l,f+g):d(l,f+g,!0)},update:function(a){return new f(this.selectors,b.extend({},this.settings,a),!0)},reset:function(){return new f(this.selectors,this.settings,!0)},remove:function(){this.selectors.each(function(){b(this).find("caption:not(.head)").remove()})}},b.fn.tableExport=function(a,b){return new f(this,a,b)};for(var g in f.prototype)b.fn.tableExport[g]=f.prototype[g];return a.default=a.TableExport=f});